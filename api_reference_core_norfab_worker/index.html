
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Network Automations Fabric documentation">
      
      
        <meta name="author" content="Denis Mulyalin">
      
      
        <link rel="canonical" href="https://dmulyalin.github.io/NORFAB/api_reference_core_norfab_worker/">
      
      
        <link rel="prev" href="../api_reference_core_norfab_broker/">
      
      
        <link rel="next" href="../api_reference_core_norfab_client/">
      
      
      <link rel="icon" href="../images/logo.jpg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.5">
    
    
      
        <title>Worker - Network Automations Fabric [NORFAB]</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="brown" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#norfab.core.worker.WorkerWatchDog" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Network Automations Fabric [NORFAB]" class="md-header__button md-logo" aria-label="Network Automations Fabric [NORFAB]" data-md-component="logo">
      
  <img src="../images/logo.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Network Automations Fabric [NORFAB]
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Worker
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="brown" data-md-color-accent="deep-orange"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/dmulyalin/norfab" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    dmulyalin/norfab
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href=".." class="md-tabs__link">
          
  
  NORFAB

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../reference_norfab_inventory/" class="md-tabs__link">
          
  
  References

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../tags/" class="md-tabs__link">
        
  
    
  
  Tags

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Network Automations Fabric [NORFAB]" class="md-nav__button md-logo" aria-label="Network Automations Fabric [NORFAB]" data-md-component="logo">
      
  <img src="../images/logo.jpg" alt="logo">

    </a>
    Network Automations Fabric [NORFAB]
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/dmulyalin/norfab" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    dmulyalin/norfab
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    NORFAB
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            NORFAB
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../norfab_installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../norfab_getting_started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../norfab_why_use_norfab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Why use NORFAB
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../norfab_distributed_deployment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Distributed Deployment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../norfab_docker_deployment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker Deployment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../norfab_help_with_norfab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Help with NORFAB
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../norfab_changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9" >
        
          
          <label class="md-nav__link" for="__nav_1_9" id="__nav_1_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Services
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_9">
            <span class="md-nav__icon md-icon"></span>
            Services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../services_overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Services Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9_2" >
        
          
          <label class="md-nav__link" for="__nav_1_9_2" id="__nav_1_9_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Nornir Service
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_9_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_9_2">
            <span class="md-nav__icon md-icon"></span>
            Nornir Service
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/nornir/services_nornir_service/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/nornir/services_nornir_service_inventory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inventory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9_2_3" >
        
          
          <label class="md-nav__link" for="__nav_1_9_2_3" id="__nav_1_9_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tasks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_9_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_9_2_3">
            <span class="md-nav__icon md-icon"></span>
            Tasks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/nornir/services_nornir_service_tasks_task/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nornir Task
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/nornir/services_nornir_service_tasks_cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CLI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/nornir/services_nornir_service_tasks_cfg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CFG
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/nornir/services_nornir_service_tasks_test/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/nornir/services_nornir_service_tasks_network/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/nornir/services_nornir_service_tasks_parse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/nornir/services_nornir_service_tasks_diagram/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Diagram
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/nornir/services_nornir_service_tasks_file_copy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File Copy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/nornir/services_nornir_service_tasks_runtime_inventory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Runtime Inventory
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/nornir/services_nornir_service_jinja2_filters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jina2 Filters Reference
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9_3" >
        
          
          <label class="md-nav__link" for="__nav_1_9_3" id="__nav_1_9_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Netbox Service
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_9_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_9_3">
            <span class="md-nav__icon md-icon"></span>
            Netbox Service
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/netbox/services_netbox_service/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/netbox/services_netbox_service_inventory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inventory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9_3_3" >
        
          
          <label class="md-nav__link" for="__nav_1_9_3_3" id="__nav_1_9_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tasks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_9_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_9_3_3">
            <span class="md-nav__icon md-icon"></span>
            Tasks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/netbox/services_netbox_service_tasks_graphql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GraphQL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/netbox/services_netbox_service_tasks_rest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/netbox/services_netbox_service_tasks_get_devices/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GET Devices
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/netbox/services_netbox_service_tasks_get_interfaces/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GET Interfaces
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/netbox/services_netbox_service_tasks_get_connections/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GET Connections
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/netbox/services_netbox_service_tasks_get_circuits/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GET Circuits
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/netbox/services_netbox_service_tasks_get_nornir_inventory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GET Nornir Inventory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/netbox/services_netbox_service_tasks_get_next_ip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GETNext IP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/netbox/services_netbox_service_tasks_update_device_facts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UPDATE Device Facts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/netbox/services_netbox_service_tasks_update_device_interfaces/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UPDATE Device Interfaces
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/netbox/services_netbox_service_tasks_update_device_ip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UPDATE Device IP
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9_4" >
        
          
          <label class="md-nav__link" for="__nav_1_9_4" id="__nav_1_9_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Ollama Agent Service
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_9_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_9_4">
            <span class="md-nav__icon md-icon"></span>
            Ollama Agent Service
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/agent/services_agent_service/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/agent/services_agent_service_inventory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inventory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9_4_3" >
        
          
          <label class="md-nav__link" for="__nav_1_9_4_3" id="__nav_1_9_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tasks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_9_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_9_4_3">
            <span class="md-nav__icon md-icon"></span>
            Tasks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/agent/services_agent_service_tasks_chat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chat
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9_5" >
        
          
          <label class="md-nav__link" for="__nav_1_9_5" id="__nav_1_9_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    FastAPI Service
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_9_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_9_5">
            <span class="md-nav__icon md-icon"></span>
            FastAPI Service
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/fastapi/services_fastapi_service/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/fastapi/services_fastapi_service_inventory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inventory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9_5_3" >
        
          
          <label class="md-nav__link" for="__nav_1_9_5_3" id="__nav_1_9_5_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tasks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_9_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_9_5_3">
            <span class="md-nav__icon md-icon"></span>
            Tasks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/fastapi/services_fastapi_service_task_auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Auth
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9_6" >
        
          
          <label class="md-nav__link" for="__nav_1_9_6" id="__nav_1_9_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    NORFAB Services
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_9_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_9_6">
            <span class="md-nav__icon md-icon"></span>
            NORFAB Services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../services_norfab_mmi.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MMI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../services_norfab_inventory_service.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inventory Service
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../services_norfab_file_service.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File Service
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../services_norfab_jobs_service.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jobs Service
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../services_norfab_events_service.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Events Service
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_10" >
        
          
          <label class="md-nav__link" for="__nav_1_10" id="__nav_1_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Clients
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_10">
            <span class="md-nav__icon md-icon"></span>
            Clients
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../clients_overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NORFAB Clients
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../clients_nfcli_overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NFCLI Shell
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../clients_python_api_overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../clients_rest_api_overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../clients_robot_client_overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ROBOT API
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_11" >
        
          
          <label class="md-nav__link" for="__nav_1_11" id="__nav_1_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Customization
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_11">
            <span class="md-nav__icon md-icon"></span>
            Customization
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../customization/norfab_hooks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NORFAB Hooks System
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_11_2" >
        
          
          <label class="md-nav__link" for="__nav_1_11_2" id="__nav_1_11_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Service Plugins
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_11_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_11_2">
            <span class="md-nav__icon md-icon"></span>
            Service Plugins
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../customization/service_plugin_overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Service Plugins Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../customization/service_plugin_local/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Local Plugin
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../customization/service_plugin_module/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python Module Plugin
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    References
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            References
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_norfab_inventory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NORFAB Inventory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_2_1" id="__nav_2_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CORE
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_2_1">
            <span class="md-nav__icon md-icon"></span>
            CORE
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_reference_core_norfab_nfapi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NFAPI (Python API)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_reference_core_norfab_broker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Broker
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Worker
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Worker
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#norfab.core.worker.WorkerWatchDog" class="md-nav__link">
    <span class="md-ellipsis">
      WorkerWatchDog
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WorkerWatchDog">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.WorkerWatchDog.check_ram" class="md-nav__link">
    <span class="md-ellipsis">
      check_ram
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.WorkerWatchDog.get_ram_usage" class="md-nav__link">
    <span class="md-ellipsis">
      get_ram_usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.WorkerWatchDog.run" class="md-nav__link">
    <span class="md-ellipsis">
      run
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#norfab.core.worker.Result" class="md-nav__link">
    <span class="md-ellipsis">
      Result
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Result">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.Result.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.Result.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.Result.raise_for_status" class="md-nav__link">
    <span class="md-ellipsis">
      raise_for_status
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.Result.dictionary" class="md-nav__link">
    <span class="md-ellipsis">
      dictionary
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker" class="md-nav__link">
    <span class="md-ellipsis">
      NFPWorker
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NFPWorker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.setup_logging" class="md-nav__link">
    <span class="md-ellipsis">
      setup_logging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.reconnect_to_broker" class="md-nav__link">
    <span class="md-ellipsis">
      reconnect_to_broker
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.send_to_broker" class="md-nav__link">
    <span class="md-ellipsis">
      send_to_broker
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.load_inventory" class="md-nav__link">
    <span class="md-ellipsis">
      load_inventory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.worker_exit" class="md-nav__link">
    <span class="md-ellipsis">
      worker_exit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.get_inventory" class="md-nav__link">
    <span class="md-ellipsis">
      get_inventory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.get_version" class="md-nav__link">
    <span class="md-ellipsis">
      get_version
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.destroy" class="md-nav__link">
    <span class="md-ellipsis">
      destroy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.is_url" class="md-nav__link">
    <span class="md-ellipsis">
      is_url
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.fetch_file" class="md-nav__link">
    <span class="md-ellipsis">
      fetch_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.fetch_jinja2" class="md-nav__link">
    <span class="md-ellipsis">
      fetch_jinja2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.event" class="md-nav__link">
    <span class="md-ellipsis">
      event
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.job_details" class="md-nav__link">
    <span class="md-ellipsis">
      job_details
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.job_list" class="md-nav__link">
    <span class="md-ellipsis">
      job_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.work" class="md-nav__link">
    <span class="md-ellipsis">
      work
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#norfab.core.worker.dumper" class="md-nav__link">
    <span class="md-ellipsis">
      dumper
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#norfab.core.worker.loader" class="md-nav__link">
    <span class="md-ellipsis">
      loader
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#norfab.core.worker.request_filename" class="md-nav__link">
    <span class="md-ellipsis">
      request_filename
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#norfab.core.worker.reply_filename" class="md-nav__link">
    <span class="md-ellipsis">
      reply_filename
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#norfab.core.worker.event_filename" class="md-nav__link">
    <span class="md-ellipsis">
      event_filename
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#norfab.core.worker._post" class="md-nav__link">
    <span class="md-ellipsis">
      _post
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#norfab.core.worker._get" class="md-nav__link">
    <span class="md-ellipsis">
      _get
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#norfab.core.worker._event" class="md-nav__link">
    <span class="md-ellipsis">
      _event
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#norfab.core.worker.recv" class="md-nav__link">
    <span class="md-ellipsis">
      recv
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_reference_core_norfab_client/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Client
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_reference_core_norfab_simple_inventory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Simple Inventory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_reference_core_norfab_exceptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exceptions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2_2" id="__nav_2_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Built-in Workers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            Built-in Workers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/nornir/api_reference_workers_nornir_worker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nornir Worker
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/netbox/api_reference_workers_netbox_worker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Netbox Worker
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/fastapi/api_reference_workers_fastapi_worker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FastAPI Worker
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workers/agent/api_reference_workers_agent_worker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ollama Agent Worker
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_2_3" id="__nav_2_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Built-in Clients
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_3">
            <span class="md-nav__icon md-icon"></span>
            Built-in Clients
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_reference_clients_nfcli_client/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NFCLI Client API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_reference_clients_robot_client/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ROBOT Client API
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_architecture_norfab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NORFAB Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_architecture_nfp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NORFAB Protocol RFC
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tags
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#norfab.core.worker.WorkerWatchDog" class="md-nav__link">
    <span class="md-ellipsis">
      WorkerWatchDog
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WorkerWatchDog">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.WorkerWatchDog.check_ram" class="md-nav__link">
    <span class="md-ellipsis">
      check_ram
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.WorkerWatchDog.get_ram_usage" class="md-nav__link">
    <span class="md-ellipsis">
      get_ram_usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.WorkerWatchDog.run" class="md-nav__link">
    <span class="md-ellipsis">
      run
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#norfab.core.worker.Result" class="md-nav__link">
    <span class="md-ellipsis">
      Result
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Result">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.Result.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.Result.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.Result.raise_for_status" class="md-nav__link">
    <span class="md-ellipsis">
      raise_for_status
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.Result.dictionary" class="md-nav__link">
    <span class="md-ellipsis">
      dictionary
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker" class="md-nav__link">
    <span class="md-ellipsis">
      NFPWorker
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NFPWorker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.setup_logging" class="md-nav__link">
    <span class="md-ellipsis">
      setup_logging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.reconnect_to_broker" class="md-nav__link">
    <span class="md-ellipsis">
      reconnect_to_broker
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.send_to_broker" class="md-nav__link">
    <span class="md-ellipsis">
      send_to_broker
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.load_inventory" class="md-nav__link">
    <span class="md-ellipsis">
      load_inventory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.worker_exit" class="md-nav__link">
    <span class="md-ellipsis">
      worker_exit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.get_inventory" class="md-nav__link">
    <span class="md-ellipsis">
      get_inventory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.get_version" class="md-nav__link">
    <span class="md-ellipsis">
      get_version
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.destroy" class="md-nav__link">
    <span class="md-ellipsis">
      destroy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.is_url" class="md-nav__link">
    <span class="md-ellipsis">
      is_url
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.fetch_file" class="md-nav__link">
    <span class="md-ellipsis">
      fetch_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.fetch_jinja2" class="md-nav__link">
    <span class="md-ellipsis">
      fetch_jinja2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.event" class="md-nav__link">
    <span class="md-ellipsis">
      event
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.job_details" class="md-nav__link">
    <span class="md-ellipsis">
      job_details
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.job_list" class="md-nav__link">
    <span class="md-ellipsis">
      job_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#norfab.core.worker.NFPWorker.work" class="md-nav__link">
    <span class="md-ellipsis">
      work
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#norfab.core.worker.dumper" class="md-nav__link">
    <span class="md-ellipsis">
      dumper
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#norfab.core.worker.loader" class="md-nav__link">
    <span class="md-ellipsis">
      loader
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#norfab.core.worker.request_filename" class="md-nav__link">
    <span class="md-ellipsis">
      request_filename
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#norfab.core.worker.reply_filename" class="md-nav__link">
    <span class="md-ellipsis">
      reply_filename
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#norfab.core.worker.event_filename" class="md-nav__link">
    <span class="md-ellipsis">
      event_filename
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#norfab.core.worker._post" class="md-nav__link">
    <span class="md-ellipsis">
      _post
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#norfab.core.worker._get" class="md-nav__link">
    <span class="md-ellipsis">
      _get
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#norfab.core.worker._event" class="md-nav__link">
    <span class="md-ellipsis">
      _event
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#norfab.core.worker.recv" class="md-nav__link">
    <span class="md-ellipsis">
      recv
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Worker</h1>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="norfab.core.worker.WorkerWatchDog" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">WorkerWatchDog</span><span class="p">(</span><span class="n">worker</span><span class="p">)</span></code>

<a href="#norfab.core.worker.WorkerWatchDog" class="headerlink" title="Permanent link">¤</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="threading.Thread">Thread</span></code></p>


        <p>Class to monitor worker performance.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.WorkerWatchDog.worker">worker</span></code></td>
            <td>
                  <code>object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The worker instance being monitored.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.WorkerWatchDog.worker_process">worker_process</span></code></td>
            <td>
                  <code><span title="psutil.Process">Process</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The process of the worker.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.WorkerWatchDog.watchdog_interval">watchdog_interval</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Interval in seconds for the watchdog to check the worker's status.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.WorkerWatchDog.memory_threshold_mbyte">memory_threshold_mbyte</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Memory usage threshold in megabytes.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.WorkerWatchDog.memory_threshold_action">memory_threshold_action</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Action to take when memory threshold is exceeded ("log" or "shutdown").</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.WorkerWatchDog.runs">runs</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Counter for the number of times the watchdog has run.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.WorkerWatchDog.watchdog_tasks">watchdog_tasks</span></code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of additional tasks to run during each watchdog interval.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="norfab.core.worker.WorkerWatchDog.check_ram" href="#norfab.core.worker.WorkerWatchDog.check_ram">check_ram</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Checks the worker's RAM usage and takes action if it exceeds the threshold.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="norfab.core.worker.WorkerWatchDog.get_ram_usage" href="#norfab.core.worker.WorkerWatchDog.get_ram_usage">get_ram_usage</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Returns the worker's RAM usage in megabytes.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="norfab.core.worker.WorkerWatchDog.run" href="#norfab.core.worker.WorkerWatchDog.run">run</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Main loop of the watchdog thread, periodically checks the worker's status and runs tasks.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>worker</code>
            </td>
            <td>
                  <code>object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The worker object containing inventory attributes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>






                  <details class="quote">
                    <summary>Source code in <code>norfab\core\worker.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">worker</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">worker</span> <span class="o">=</span> <span class="n">worker</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">worker_process</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">())</span>

    <span class="c1"># extract inventory attributes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">watchdog_interval</span> <span class="o">=</span> <span class="n">worker</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;watchdog_interval&quot;</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">memory_threshold_mbyte</span> <span class="o">=</span> <span class="n">worker</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="s2">&quot;memory_threshold_mbyte&quot;</span><span class="p">,</span> <span class="mi">1000</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">memory_threshold_action</span> <span class="o">=</span> <span class="n">worker</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="s2">&quot;memory_threshold_action&quot;</span><span class="p">,</span> <span class="s2">&quot;log&quot;</span>
    <span class="p">)</span>

    <span class="c1"># initiate variables</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">runs</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">watchdog_tasks</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="norfab.core.worker.WorkerWatchDog.check_ram" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_ram</span><span class="p">()</span></code>

<a href="#norfab.core.worker.WorkerWatchDog.check_ram" class="headerlink" title="Permanent link">¤</a></h3>


    <div class="doc doc-contents ">

        <p>Checks the current RAM usage and performs an action if it exceeds the threshold.</p>
<p>This method retrieves the current RAM usage and compares it to the predefined
memory threshold. If the RAM usage exceeds the threshold, it performs an action
based on the <code>memory_threshold_action</code> attribute. The possible actions are:</p>
<ul>
<li>"log": Logs a warning message.</li>
<li>"shutdown": Raises a SystemExit exception to terminate the program.</li>
</ul>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>SystemExit</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the memory usage exceeds the threshold and the action is "shutdown".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check_ram</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks the current RAM usage and performs an action if it exceeds the threshold.</span>

<span class="sd">    This method retrieves the current RAM usage and compares it to the predefined</span>
<span class="sd">    memory threshold. If the RAM usage exceeds the threshold, it performs an action</span>
<span class="sd">    based on the `memory_threshold_action` attribute. The possible actions are:</span>

<span class="sd">    - &quot;log&quot;: Logs a warning message.</span>
<span class="sd">    - &quot;shutdown&quot;: Raises a SystemExit exception to terminate the program.</span>

<span class="sd">    Raises:</span>
<span class="sd">        SystemExit: If the memory usage exceeds the threshold and the action is &quot;shutdown&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mem_usage</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ram_usage</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">mem_usage</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory_threshold_mbyte</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory_threshold_action</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> watchdog, &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">memory_threshold_mbyte</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;memory_threshold_mbyte exceeded, memory usage &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mem_usage</span><span class="si">}</span><span class="s2">MByte&quot;</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory_threshold_action</span> <span class="o">==</span> <span class="s2">&quot;shutdown&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> watchdog, &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">memory_threshold_mbyte</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;memory_threshold_mbyte exceeded, memory usage &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mem_usage</span><span class="si">}</span><span class="s2">MByte, killing myself&quot;</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="norfab.core.worker.WorkerWatchDog.get_ram_usage" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_ram_usage</span><span class="p">()</span></code>

<a href="#norfab.core.worker.WorkerWatchDog.get_ram_usage" class="headerlink" title="Permanent link">¤</a></h3>


    <div class="doc doc-contents ">

        <p>Get the RAM usage of the worker process.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The RAM usage in megabytes.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_ram_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the RAM usage of the worker process.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The RAM usage in megabytes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">worker_process</span><span class="o">.</span><span class="n">memory_info</span><span class="p">()</span><span class="o">.</span><span class="n">rss</span> <span class="o">/</span> <span class="mi">1024000</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="norfab.core.worker.WorkerWatchDog.run" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run</span><span class="p">()</span></code>

<a href="#norfab.core.worker.WorkerWatchDog.run" class="headerlink" title="Permanent link">¤</a></h3>


    <div class="doc doc-contents ">

        <p>Executes the worker's watchdog main loop, periodically running tasks and checking conditions.
The method performs the following steps in a loop until the worker's exit event is set:</p>
<ol>
<li>Sleeps in increments of 0.1 seconds until the total sleep time reaches the watchdog interval.</li>
<li>Runs built-in tasks such as checking RAM usage.</li>
<li>Executes additional tasks provided by child classes.</li>
<li>Updates the run counter.</li>
<li>Resets the sleep counter to start the cycle again.</li>
</ol>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.WorkerWatchDog.run.slept">slept</span></code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The total time slept in the current cycle.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Executes the worker&#39;s watchdog main loop, periodically running tasks and checking conditions.</span>
<span class="sd">    The method performs the following steps in a loop until the worker&#39;s exit event is set:</span>

<span class="sd">    1. Sleeps in increments of 0.1 seconds until the total sleep time reaches the watchdog interval.</span>
<span class="sd">    2. Runs built-in tasks such as checking RAM usage.</span>
<span class="sd">    3. Executes additional tasks provided by child classes.</span>
<span class="sd">    4. Updates the run counter.</span>
<span class="sd">    5. Resets the sleep counter to start the cycle again.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        slept (float): The total time slept in the current cycle.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">slept</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">exit_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
        <span class="c1"># continue sleeping for watchdog_interval</span>
        <span class="k">if</span> <span class="n">slept</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">watchdog_interval</span><span class="p">:</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
            <span class="n">slept</span> <span class="o">+=</span> <span class="mf">0.1</span>
            <span class="k">continue</span>

        <span class="c1"># run built in tasks:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_ram</span><span class="p">()</span>

        <span class="c1"># run child classes tasks</span>
        <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">watchdog_tasks</span><span class="p">:</span>
            <span class="n">task</span><span class="p">()</span>

        <span class="c1"># update counters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runs</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">slept</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># reset to go to sleep</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="norfab.core.worker.Result" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">Result</span><span class="p">(</span><span class="n">result</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">failed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">errors</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">task</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">messages</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">juuid</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span></code>

<a href="#norfab.core.worker.Result" class="headerlink" title="Permanent link">¤</a></h2>


    <div class="doc doc-contents ">


        <p>NorFab Task Result class.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>result</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Result of the task execution, see task's documentation for details.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>failed</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the execution failed or not.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>errors</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exception thrown during the execution of the task (if any).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>task</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Task function name that produced the results.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>messages</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of messages produced by the task.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>juuid</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Job UUID associated with the task.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="norfab.core.worker.Result.__repr__" href="#norfab.core.worker.Result.__repr__">__repr__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Returns a string representation of the Result object.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="norfab.core.worker.Result.__str__" href="#norfab.core.worker.Result.__str__">__str__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Returns a string representation of the result or errors.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="norfab.core.worker.Result.raise_for_status" href="#norfab.core.worker.Result.raise_for_status">raise_for_status</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Raises an error if the job failed.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="norfab.core.worker.Result.dictionary" href="#norfab.core.worker.Result.dictionary">dictionary</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Serializes the result to a dictionary.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>






                  <details class="quote">
                    <summary>Source code in <code>norfab\core\worker.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">result</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">failed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">errors</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">task</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">messages</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">juuid</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">task</span> <span class="o">=</span> <span class="n">task</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="n">result</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">failed</span> <span class="o">=</span> <span class="n">failed</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span> <span class="ow">or</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">messages</span> <span class="o">=</span> <span class="n">messages</span> <span class="ow">or</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">juuid</span> <span class="o">=</span> <span class="n">juuid</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="norfab.core.worker.Result.__repr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

<a href="#norfab.core.worker.Result.__repr__" class="headerlink" title="Permanent link">¤</a></h3>


    <div class="doc doc-contents ">

        <p>Return a string representation of the object.</p>
<p>The string representation includes the class name and the task attribute.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string in the format 'ClassName: "task"'.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a string representation of the object.</span>

<span class="sd">    The string representation includes the class name and the task attribute.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: A string in the format &#39;ClassName: &quot;task&quot;&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">: &quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">task</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="norfab.core.worker.Result.__str__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

<a href="#norfab.core.worker.Result.__str__" class="headerlink" title="Permanent link">¤</a></h3>


    <div class="doc doc-contents ">

        <p>Returns a string representation of the object.</p>
<p>If there are errors, it joins them with two newline characters and returns the result.
Otherwise, it returns the string representation of the result.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The string representation of the errors or the result.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a string representation of the object.</span>

<span class="sd">    If there are errors, it joins them with two newline characters and returns the result.</span>
<span class="sd">    Otherwise, it returns the string representation of the result.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The string representation of the errors or the result.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">))</span>

    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="norfab.core.worker.Result.raise_for_status" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">raise_for_status</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

<a href="#norfab.core.worker.Result.raise_for_status" class="headerlink" title="Permanent link">¤</a></h3>


    <div class="doc doc-contents ">

        <p>Raises a NorfabJobFailedError if the job has failed.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional. Additional message to include in the error. Default is an empty string.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="norfab.core.exceptions.NorfabJobFailedError" href="../api_reference_core_norfab_exceptions/#norfab.core.exceptions.NorfabJobFailedError">NorfabJobFailedError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the job has failed, this error is raised with the provided message and the list of errors.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">raise_for_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Raises a NorfabJobFailedError if the job has failed.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        message (str): Optional. Additional message to include in the error. Default is an empty string.</span>

<span class="sd">    Raises:</span>
<span class="sd">        NorfabJobFailedError: If the job has failed, this error is raised with the provided message and the list of errors.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">failed</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">message</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NorfabJobFailedError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">; Errors: </span><span class="si">{</span><span class="s1">&#39;; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NorfabJobFailedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Errors: </span><span class="si">{</span><span class="s1">&#39;; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="norfab.core.worker.Result.dictionary" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dictionary</span><span class="p">()</span></code>

<a href="#norfab.core.worker.Result.dictionary" class="headerlink" title="Permanent link">¤</a></h3>


    <div class="doc doc-contents ">

        <p>Serialize the result to a dictionary.</p>
<p>This method converts the instance attributes to a dictionary format.
It ensures that the <code>errors</code> and <code>messages</code> attributes are lists.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the following keys:</p>
<ul>
<li>task: The task associated with the worker.</li>
<li>failed: A boolean indicating if the task failed.</li>
<li>errors: A list of errors encountered during the task.</li>
<li>result: The result of the task.</li>
<li>messages: A list of messages related to the task.</li>
<li>juuid: The unique identifier for the job.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">dictionary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Serialize the result to a dictionary.</span>

<span class="sd">    This method converts the instance attributes to a dictionary format.</span>
<span class="sd">    It ensures that the `errors` and `messages` attributes are lists.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing the following keys:</span>

<span class="sd">            - task: The task associated with the worker.</span>
<span class="sd">            - failed: A boolean indicating if the task failed.</span>
<span class="sd">            - errors: A list of errors encountered during the task.</span>
<span class="sd">            - result: The result of the task.</span>
<span class="sd">            - messages: A list of messages related to the task.</span>
<span class="sd">            - juuid: The unique identifier for the job.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messages</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="p">]</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;task&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">task</span><span class="p">,</span>
        <span class="s2">&quot;failed&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">failed</span><span class="p">,</span>
        <span class="s2">&quot;errors&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">,</span>
        <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="p">,</span>
        <span class="s2">&quot;messages&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">messages</span><span class="p">,</span>
        <span class="s2">&quot;juuid&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">juuid</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="norfab.core.worker.NFPWorker" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">NFPWorker</span><span class="p">(</span><span class="n">inventory</span><span class="p">:</span> <span class="n">NorFabInventory</span><span class="p">,</span> <span class="n">broker</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">service</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">exit_event</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> <span class="n">log_level</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">log_queue</span><span class="p">:</span> <span class="nb">object</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">multiplier</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">keepalive</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2500</span><span class="p">)</span></code>

<a href="#norfab.core.worker.NFPWorker" class="headerlink" title="Permanent link">¤</a></h2>


    <div class="doc doc-contents ">


        <p>NFPWorker class is responsible for managing worker operations,
including connecting to a broker, handling jobs,  and maintaining
keepalive connections. It interacts with the broker using ZeroMQ
and manages job queues and events.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>inventory</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="norfab.core.inventory.NorFabInventory" href="../api_reference_core_norfab_simple_inventory/#norfab.core.inventory.NorFabInventory">NorFabInventory</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The inventory object containing base directory information.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>broker</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The broker address.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>service</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The service name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the worker.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exit_event</code>
            </td>
            <td>
                  <code>object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The event used to signal the worker to exit.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>log_level</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The logging level. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>log_queue</code>
            </td>
            <td>
                  <code>object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The logging queue. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>multiplier</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The multiplier value. Defaults to 6.</p>
              </div>
            </td>
            <td>
                  <code>6</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>keepalive</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The keepalive interval in milliseconds. Defaults to 2500.</p>
              </div>
            </td>
            <td>
                  <code>2500</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.NFPWorker.inventory">inventory</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="norfab.core.inventory.NorFabInventory" href="../api_reference_core_norfab_simple_inventory/#norfab.core.inventory.NorFabInventory">NorFabInventory</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The inventory object.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.NFPWorker.broker">broker</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The broker address.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.NFPWorker.service">service</span></code></td>
            <td>
                  <code>bytes</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The service name encoded in UTF-8.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.NFPWorker.name">name</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the worker.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.NFPWorker.exit_event">exit_event</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The event used to signal the worker to exit.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.NFPWorker.broker_socket">broker_socket</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The broker socket, initialized to None.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.NFPWorker.multiplier">multiplier</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The multiplier value.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.NFPWorker.keepalive">keepalive</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The keepalive interval in milliseconds.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.NFPWorker.socket_lock">socket_lock</span></code></td>
            <td>
                  <code><span title="threading.Lock">Lock</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The lock used to protect the socket object.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.NFPWorker.base_dir">base_dir</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The base directory for the worker.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.NFPWorker.base_dir_jobs">base_dir_jobs</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The base directory for job files.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.NFPWorker.destroy_event">destroy_event</span></code></td>
            <td>
                  <code><span title="threading.Event">Event</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The event used to signal the destruction of the worker.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.NFPWorker.request_thread">request_thread</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The request thread, initialized to None.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.NFPWorker.reply_thread">reply_thread</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The reply thread, initialized to None.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.NFPWorker.close_thread">close_thread</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The close thread, initialized to None.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.NFPWorker.recv_thread">recv_thread</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The receive thread, initialized to None.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.NFPWorker.event_thread">event_thread</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The event thread, initialized to None.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.NFPWorker.post_queue">post_queue</span></code></td>
            <td>
                  <code><span title="queue.Queue">Queue</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The queue for POST requests.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.NFPWorker.get_queue">get_queue</span></code></td>
            <td>
                  <code><span title="queue.Queue">Queue</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The queue for GET requests.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.NFPWorker.delete_queue">delete_queue</span></code></td>
            <td>
                  <code><span title="queue.Queue">Queue</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The queue for DELETE requests.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.NFPWorker.event_queue">event_queue</span></code></td>
            <td>
                  <code><span title="queue.Queue">Queue</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The queue for events.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.NFPWorker.public_keys_dir">public_keys_dir</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The directory for public keys.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.NFPWorker.secret_keys_dir">secret_keys_dir</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The directory for private keys.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.NFPWorker.ctx">ctx</span></code></td>
            <td>
                  <code><span title="zmq.Context">Context</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ZeroMQ context.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.NFPWorker.poller">poller</span></code></td>
            <td>
                  <code><span title="zmq.Poller">Poller</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ZeroMQ poller.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.NFPWorker.queue_filename">queue_filename</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The filename for the job queue.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.NFPWorker.queue_done_filename">queue_done_filename</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The filename for the completed job queue.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="norfab.core.worker.NFPWorker.client">client</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="norfab.core.client.NFPClient" href="../api_reference_core_norfab_client/#norfab.core.client.NFPClient">NFPClient</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The NFP client instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="norfab.core.worker.NFPWorker.setup_logging" href="#norfab.core.worker.NFPWorker.setup_logging">setup_logging</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Configures logging for the worker.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="norfab.core.worker.NFPWorker.reconnect_to_broker" href="#norfab.core.worker.NFPWorker.reconnect_to_broker">reconnect_to_broker</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Connects or reconnects the worker to the broker.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="norfab.core.worker.NFPWorker.send_to_broker" href="#norfab.core.worker.NFPWorker.send_to_broker">send_to_broker</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Sends a message to the broker with the specified command and optional message content.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="norfab.core.worker.NFPWorker.load_inventory" href="#norfab.core.worker.NFPWorker.load_inventory">load_inventory</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Loads the inventory from the broker for this worker name.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="norfab.core.worker.NFPWorker.worker_exit" href="#norfab.core.worker.NFPWorker.worker_exit">worker_exit</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Method to override in child classes with a set of actions to perform on exit call.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="norfab.core.worker.NFPWorker.get_inventory" href="#norfab.core.worker.NFPWorker.get_inventory">get_inventory</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Method to override in child classes to retrieve worker inventory.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="norfab.core.worker.NFPWorker.get_version" href="#norfab.core.worker.NFPWorker.get_version">get_version</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Method to override in child classes to retrieve worker version report.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="norfab.core.worker.NFPWorker.destroy" href="#norfab.core.worker.NFPWorker.destroy">destroy</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Cleans up and destroys the worker, stopping all threads and connections.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="norfab.core.worker.NFPWorker.is_url" href="#norfab.core.worker.NFPWorker.is_url">is_url</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Checks if the provided URL is in the expected format.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="norfab.core.worker.NFPWorker.fetch_file" href="#norfab.core.worker.NFPWorker.fetch_file">fetch_file</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Downloads a file from the broker File Sharing Service.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="norfab.core.worker.NFPWorker.fetch_jinja2" href="#norfab.core.worker.NFPWorker.fetch_jinja2">fetch_jinja2</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Recursively downloads a Jinja2 template and its included templates.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="norfab.core.worker.NFPWorker.event" href="#norfab.core.worker.NFPWorker.event">event</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Emits an event to the broker and saves it locally.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="norfab.core.worker.NFPWorker.job_details" href="#norfab.core.worker.NFPWorker.job_details">job_details</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Retrieves job details by UUID for completed jobs.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="norfab.core.worker.NFPWorker.job_list" href="#norfab.core.worker.NFPWorker.job_list">job_list</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Lists worker jobs, both completed and pending.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="norfab.core.worker.NFPWorker.work" href="#norfab.core.worker.NFPWorker.work">work</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Starts the worker's main loop, processing jobs from the queue.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>






                  <details class="quote">
                    <summary>Source code in <code>norfab\core\worker.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">inventory</span><span class="p">:</span> <span class="n">NorFabInventory</span><span class="p">,</span>
    <span class="n">broker</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">service</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">exit_event</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">log_level</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">log_queue</span><span class="p">:</span> <span class="nb">object</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">multiplier</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">keepalive</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2500</span><span class="p">,</span>
<span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setup_logging</span><span class="p">(</span><span class="n">log_queue</span><span class="p">,</span> <span class="n">log_level</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">inventory</span> <span class="o">=</span> <span class="n">inventory</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">broker</span> <span class="o">=</span> <span class="n">broker</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">service</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">service</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">service</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">exit_event</span> <span class="o">=</span> <span class="n">exit_event</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">broker_socket</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span> <span class="o">=</span> <span class="n">multiplier</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">keepalive</span> <span class="o">=</span> <span class="n">keepalive</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">socket_lock</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
    <span class="p">)</span>  <span class="c1"># used for keepalives to protect socket object</span>

    <span class="c1"># create base directories</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">base_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">&quot;__norfab__&quot;</span><span class="p">,</span> <span class="s2">&quot;files&quot;</span><span class="p">,</span> <span class="s2">&quot;worker&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">base_dir_jobs</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">&quot;jobs&quot;</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_dir_jobs</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># create events and queues</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">destroy_event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">request_thread</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reply_thread</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">close_thread</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">recv_thread</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">event_thread</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">post_queue</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">get_queue</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">delete_queue</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">event_queue</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># generate certificates and create directories</span>
    <span class="n">generate_certificates</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_dir</span><span class="p">,</span>
        <span class="n">cert_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">broker_keys_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">&quot;__norfab__&quot;</span><span class="p">,</span> <span class="s2">&quot;files&quot;</span><span class="p">,</span> <span class="s2">&quot;broker&quot;</span><span class="p">,</span> <span class="s2">&quot;public_keys&quot;</span>
        <span class="p">),</span>
        <span class="n">inventory</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">inventory</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">public_keys_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">&quot;public_keys&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">secret_keys_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">&quot;private_keys&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">ctx</span> <span class="o">=</span> <span class="n">zmq</span><span class="o">.</span><span class="n">Context</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">poller</span> <span class="o">=</span> <span class="n">zmq</span><span class="o">.</span><span class="n">Poller</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reconnect_to_broker</span><span class="p">()</span>

    <span class="c1"># create queue file</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">queue_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_dir_jobs</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.queue.txt&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">queue_filename</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">queue_filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">queue_done_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_dir_jobs</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.queue.done.txt&quot;</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">queue_done_filename</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">queue_done_filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">NFPClient</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inventory</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">broker</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">-NFPClient&quot;</span><span class="p">,</span>
        <span class="n">exit_event</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exit_event</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="norfab.core.worker.NFPWorker.setup_logging" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">setup_logging</span><span class="p">(</span><span class="n">log_queue</span><span class="p">,</span> <span class="n">log_level</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

<a href="#norfab.core.worker.NFPWorker.setup_logging" class="headerlink" title="Permanent link">¤</a></h3>


    <div class="doc doc-contents ">

        <p>Configures logging for the worker.</p>
<p>This method sets up the logging configuration using a provided log queue and log level.
It updates the logging configuration dictionary with the given log queue and log level,
and then applies the configuration using <code>logging.config.dictConfig</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>log_queue</code>
            </td>
            <td>
                  <code><span title="queue.Queue">Queue</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The queue to be used for logging.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>log_level</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The logging level to be set. If None, the default level is used.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">setup_logging</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_queue</span><span class="p">,</span> <span class="n">log_level</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Configures logging for the worker.</span>

<span class="sd">    This method sets up the logging configuration using a provided log queue and log level.</span>
<span class="sd">    It updates the logging configuration dictionary with the given log queue and log level,</span>
<span class="sd">    and then applies the configuration using `logging.config.dictConfig`.</span>

<span class="sd">    Args:</span>
<span class="sd">        log_queue (queue.Queue): The queue to be used for logging.</span>
<span class="sd">        log_level (str): The logging level to be set. If None, the default level is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logging_config_producer</span><span class="p">[</span><span class="s2">&quot;handlers&quot;</span><span class="p">][</span><span class="s2">&quot;queue&quot;</span><span class="p">][</span><span class="s2">&quot;queue&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">log_queue</span>
    <span class="k">if</span> <span class="n">log_level</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">logging_config_producer</span><span class="p">[</span><span class="s2">&quot;root&quot;</span><span class="p">][</span><span class="s2">&quot;level&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">log_level</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">dictConfig</span><span class="p">(</span><span class="n">logging_config_producer</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="norfab.core.worker.NFPWorker.reconnect_to_broker" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reconnect_to_broker</span><span class="p">()</span></code>

<a href="#norfab.core.worker.NFPWorker.reconnect_to_broker" class="headerlink" title="Permanent link">¤</a></h3>


    <div class="doc doc-contents ">

        <p>Connect or reconnect to the broker.</p>
<p>This method handles the connection or reconnection process to the broker.
It performs the following steps:</p>
<ol>
<li>If there is an existing broker socket, it sends a disconnect message,
   unregisters the socket from the poller, and closes the socket.</li>
<li>Creates a new DEALER socket and sets its identity.</li>
<li>Loads the client's secret and public keys for CURVE authentication.</li>
<li>Loads the server's public key for CURVE authentication.</li>
<li>Connects the socket to the broker.</li>
<li>Registers the socket with the poller for incoming messages.</li>
<li>Sends a READY message to the broker to register the service.</li>
<li>Starts or restarts the keepalive mechanism to maintain the connection.</li>
<li>Increments the reconnect statistics counter.</li>
<li>Logs the successful registration to the broker.</li>
</ol>

            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reconnect_to_broker</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Connect or reconnect to the broker.</span>

<span class="sd">    This method handles the connection or reconnection process to the broker.</span>
<span class="sd">    It performs the following steps:</span>

<span class="sd">    1. If there is an existing broker socket, it sends a disconnect message,</span>
<span class="sd">       unregisters the socket from the poller, and closes the socket.</span>
<span class="sd">    2. Creates a new DEALER socket and sets its identity.</span>
<span class="sd">    3. Loads the client&#39;s secret and public keys for CURVE authentication.</span>
<span class="sd">    4. Loads the server&#39;s public key for CURVE authentication.</span>
<span class="sd">    5. Connects the socket to the broker.</span>
<span class="sd">    6. Registers the socket with the poller for incoming messages.</span>
<span class="sd">    7. Sends a READY message to the broker to register the service.</span>
<span class="sd">    8. Starts or restarts the keepalive mechanism to maintain the connection.</span>
<span class="sd">    9. Increments the reconnect statistics counter.</span>
<span class="sd">    10. Logs the successful registration to the broker.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">broker_socket</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_to_broker</span><span class="p">(</span><span class="n">NFP</span><span class="o">.</span><span class="n">DISCONNECT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">poller</span><span class="o">.</span><span class="n">unregister</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">broker_socket</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">broker_socket</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">broker_socket</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctx</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">zmq</span><span class="o">.</span><span class="n">DEALER</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">broker_socket</span><span class="o">.</span><span class="n">setsockopt_unicode</span><span class="p">(</span><span class="n">zmq</span><span class="o">.</span><span class="n">IDENTITY</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">broker_socket</span><span class="o">.</span><span class="n">linger</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># We need two certificates, one for the client and one for</span>
    <span class="c1"># the server. The client must know the server&#39;s public key</span>
    <span class="c1"># to make a CURVE connection.</span>
    <span class="n">client_secret_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">secret_keys_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.key_secret&quot;</span>
    <span class="p">)</span>
    <span class="n">client_public</span><span class="p">,</span> <span class="n">client_secret</span> <span class="o">=</span> <span class="n">zmq</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">load_certificate</span><span class="p">(</span><span class="n">client_secret_file</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">broker_socket</span><span class="o">.</span><span class="n">curve_secretkey</span> <span class="o">=</span> <span class="n">client_secret</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">broker_socket</span><span class="o">.</span><span class="n">curve_publickey</span> <span class="o">=</span> <span class="n">client_public</span>

    <span class="c1"># The client must know the server&#39;s public key to make a CURVE connection.</span>
    <span class="n">server_public_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">public_keys_dir</span><span class="p">,</span> <span class="s2">&quot;broker.key&quot;</span><span class="p">)</span>
    <span class="n">server_public</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">zmq</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">load_certificate</span><span class="p">(</span><span class="n">server_public_file</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">broker_socket</span><span class="o">.</span><span class="n">curve_serverkey</span> <span class="o">=</span> <span class="n">server_public</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">broker_socket</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">broker</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">poller</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">broker_socket</span><span class="p">,</span> <span class="n">zmq</span><span class="o">.</span><span class="n">POLLIN</span><span class="p">)</span>

    <span class="c1"># Register service with broker</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">send_to_broker</span><span class="p">(</span><span class="n">NFP</span><span class="o">.</span><span class="n">READY</span><span class="p">)</span>

    <span class="c1"># start keepalives</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keepaliver</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keepaliver</span><span class="o">.</span><span class="n">restart</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">broker_socket</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keepaliver</span> <span class="o">=</span> <span class="n">KeepAliver</span><span class="p">(</span>
            <span class="n">address</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">socket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">broker_socket</span><span class="p">,</span>
            <span class="n">multiplier</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">,</span>
            <span class="n">keepalive</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">keepalive</span><span class="p">,</span>
            <span class="n">exit_event</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">destroy_event</span><span class="p">,</span>
            <span class="n">service</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="p">,</span>
            <span class="n">whoami</span><span class="o">=</span><span class="n">NFP</span><span class="o">.</span><span class="n">WORKER</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">socket_lock</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">socket_lock</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keepaliver</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">stats_reconnect_to_broker</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> - registered to broker at &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">broker</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;service &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="norfab.core.worker.NFPWorker.send_to_broker" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">send_to_broker</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span></code>

<a href="#norfab.core.worker.NFPWorker.send_to_broker" class="headerlink" title="Permanent link">¤</a></h3>


    <div class="doc doc-contents ">

        <p>Send a message to the broker.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>command</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The command to send to the broker. Must be one of NFP.READY, NFP.DISCONNECT, NFP.RESPONSE, or NFP.EVENT.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>msg</code>
            </td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The message to send. If not provided, a default message will be created based on the command.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="logs" open>
  <summary>Logs</summary>
  <p>Logs an error if the command is unsupported.
Logs a debug message with the message being sent.</p>
</details>

<details class="thread-safety" open>
  <summary>Thread Safety</summary>
  <p>This method is thread-safe and uses a lock to ensure that the broker socket is accessed by only one thread at a time.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">send_to_broker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Send a message to the broker.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        command (str): The command to send to the broker. Must be one of NFP.READY, NFP.DISCONNECT, NFP.RESPONSE, or NFP.EVENT.</span>
<span class="sd">        msg (list, optional): The message to send. If not provided, a default message will be created based on the command.</span>

<span class="sd">    Logs:</span>
<span class="sd">        Logs an error if the command is unsupported.</span>
<span class="sd">        Logs a debug message with the message being sent.</span>

<span class="sd">    Thread Safety:</span>
<span class="sd">        This method is thread-safe and uses a lock to ensure that the broker socket is accessed by only one thread at a time.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">command</span> <span class="o">==</span> <span class="n">NFP</span><span class="o">.</span><span class="n">READY</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">NFP</span><span class="o">.</span><span class="n">WORKER</span><span class="p">,</span> <span class="n">NFP</span><span class="o">.</span><span class="n">READY</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="n">NFP</span><span class="o">.</span><span class="n">DISCONNECT</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">NFP</span><span class="o">.</span><span class="n">WORKER</span><span class="p">,</span> <span class="n">NFP</span><span class="o">.</span><span class="n">DISCONNECT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="n">NFP</span><span class="o">.</span><span class="n">RESPONSE</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">NFP</span><span class="o">.</span><span class="n">WORKER</span><span class="p">,</span> <span class="n">NFP</span><span class="o">.</span><span class="n">RESPONSE</span><span class="p">]</span> <span class="o">+</span> <span class="n">msg</span>
    <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="n">NFP</span><span class="o">.</span><span class="n">EVENT</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">NFP</span><span class="o">.</span><span class="n">WORKER</span><span class="p">,</span> <span class="n">NFP</span><span class="o">.</span><span class="n">EVENT</span><span class="p">]</span> <span class="o">+</span> <span class="n">msg</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> - cannot send &#39;</span><span class="si">{</span><span class="n">command</span><span class="si">}</span><span class="s2">&#39; to broker, command unsupported&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> - sending &#39;</span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">socket_lock</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">broker_socket</span><span class="o">.</span><span class="n">send_multipart</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="norfab.core.worker.NFPWorker.load_inventory" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_inventory</span><span class="p">()</span></code>

<a href="#norfab.core.worker.NFPWorker.load_inventory" class="headerlink" title="Permanent link">¤</a></h3>


    <div class="doc doc-contents ">

        <p>Load inventory data from the broker for this worker.</p>
<p>This function retrieves inventory data from the broker service using the worker's name.
It logs the received inventory data and returns the results if available.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The inventory data results if available, otherwise an empty dictionary.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_inventory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load inventory data from the broker for this worker.</span>

<span class="sd">    This function retrieves inventory data from the broker service using the worker&#39;s name.</span>
<span class="sd">    It logs the received inventory data and returns the results if available.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: The inventory data results if available, otherwise an empty dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">inventory_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="s2">&quot;sid.service.broker&quot;</span><span class="p">,</span> <span class="s2">&quot;get_inventory&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">}</span>
    <span class="p">)</span>

    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> - worker received invenotry data </span><span class="si">{</span><span class="n">inventory_data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">inventory_data</span><span class="p">[</span><span class="s2">&quot;results&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">inventory_data</span><span class="p">[</span><span class="s2">&quot;results&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="norfab.core.worker.NFPWorker.worker_exit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">worker_exit</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

<a href="#norfab.core.worker.NFPWorker.worker_exit" class="headerlink" title="Permanent link">¤</a></h3>


    <div class="doc doc-contents ">

        <p>Method to override in child classes with a set of actions to perform on exit call.</p>
<p>This method should be implemented by subclasses to define any cleanup or finalization
tasks that need to be performed when the worker is exiting.</p>

            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">worker_exit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Method to override in child classes with a set of actions to perform on exit call.</span>

<span class="sd">    This method should be implemented by subclasses to define any cleanup or finalization</span>
<span class="sd">    tasks that need to be performed when the worker is exiting.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="norfab.core.worker.NFPWorker.get_inventory" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_inventory</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span></code>

<a href="#norfab.core.worker.NFPWorker.get_inventory" class="headerlink" title="Permanent link">¤</a></h3>


    <div class="doc doc-contents ">

        <p>Retrieve the worker's inventory.</p>
<p>This method should be overridden in child classes to provide the specific
implementation for retrieving the inventory of a worker.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Dict</code></td>            <td>
                  <code><span title="typing.Dict">Dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary representing the worker's inventory.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>NotImplementedError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the method is not overridden in a child class.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_inventory</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve the worker&#39;s inventory.</span>

<span class="sd">    This method should be overridden in child classes to provide the specific</span>
<span class="sd">    implementation for retrieving the inventory of a worker.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict: A dictionary representing the worker&#39;s inventory.</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotImplementedError: If the method is not overridden in a child class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="norfab.core.worker.NFPWorker.get_version" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_version</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span></code>

<a href="#norfab.core.worker.NFPWorker.get_version" class="headerlink" title="Permanent link">¤</a></h3>


    <div class="doc doc-contents ">

        <p>Retrieve the version report of the worker.</p>
<p>This method should be overridden in child classes to provide the specific
version report of the worker.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Dict</code></td>            <td>
                  <code><span title="typing.Dict">Dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the version information of the worker.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>NotImplementedError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the method is not overridden in a child class.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_version</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve the version report of the worker.</span>

<span class="sd">    This method should be overridden in child classes to provide the specific</span>
<span class="sd">    version report of the worker.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict: A dictionary containing the version information of the worker.</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotImplementedError: If the method is not overridden in a child class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="norfab.core.worker.NFPWorker.destroy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">destroy</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#norfab.core.worker.NFPWorker.destroy" class="headerlink" title="Permanent link">¤</a></h3>


    <div class="doc doc-contents ">

        <p>Cleanly shuts down the worker by performing the following steps:</p>
<ol>
<li>Calls the worker_exit method to handle any worker-specific exit procedures.</li>
<li>Sets the destroy_event to signal that the worker is being destroyed.</li>
<li>Calls the destroy method on the client to clean up client resources.</li>
<li>Joins all the threads (request_thread, reply_thread, close_thread, event_thread, recv_thread) if they are not None, ensuring they have finished execution.</li>
<li>Destroys the context with a linger period of 0 to immediately close all sockets.</li>
<li>Stops the keepaliver to cease any keepalive signals.</li>
<li>Logs an informational message indicating that the worker has been destroyed, including an optional message.</li>
</ol>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An optional message to include in the log when the worker is destroyed.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">destroy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cleanly shuts down the worker by performing the following steps:</span>

<span class="sd">    1. Calls the worker_exit method to handle any worker-specific exit procedures.</span>
<span class="sd">    2. Sets the destroy_event to signal that the worker is being destroyed.</span>
<span class="sd">    3. Calls the destroy method on the client to clean up client resources.</span>
<span class="sd">    4. Joins all the threads (request_thread, reply_thread, close_thread, event_thread, recv_thread) if they are not None, ensuring they have finished execution.</span>
<span class="sd">    5. Destroys the context with a linger period of 0 to immediately close all sockets.</span>
<span class="sd">    6. Stops the keepaliver to cease any keepalive signals.</span>
<span class="sd">    7. Logs an informational message indicating that the worker has been destroyed, including an optional message.</span>

<span class="sd">    Args:</span>
<span class="sd">        message (str, optional): An optional message to include in the log when the worker is destroyed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">worker_exit</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">destroy_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>

    <span class="c1"># join all the threads</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_thread</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">request_thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reply_thread</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reply_thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">close_thread</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">event_thread</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">event_thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">recv_thread</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recv_thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">ctx</span><span class="o">.</span><span class="n">destroy</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># stop keepalives</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">keepaliver</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> - worker destroyed, message: &#39;</span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="norfab.core.worker.NFPWorker.is_url" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_url</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

<a href="#norfab.core.worker.NFPWorker.is_url" class="headerlink" title="Permanent link">¤</a></h3>


    <div class="doc doc-contents ">

        <p>Check if the given string is a URL supported by NorFab File Service.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>url</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The URL to check.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the URL supported by NorFab File Service, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if the given string is a URL supported by NorFab File Service.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): The URL to check.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if the URL supported by NorFab File Service, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;nf://&quot;</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="norfab.core.worker.NFPWorker.fetch_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fetch_file</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">raise_on_fail</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">read</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

<a href="#norfab.core.worker.NFPWorker.fetch_file" class="headerlink" title="Permanent link">¤</a></h3>


    <div class="doc doc-contents ">

        <p>Function to download file from broker File Sharing Service</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>url</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>file location string in <code>nf://&lt;filepath&gt;</code> format</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>raise_on_fail</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>raise FIleNotFoundError if download fails</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>read</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if True returns file content, return OS path to saved file otherwise</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>File content if read is True, otherwise OS path to the saved file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>FileNotFoundError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If raise_on_fail is True and the download fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fetch_file</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">raise_on_fail</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">read</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to download file from broker File Sharing Service</span>

<span class="sd">    Args:</span>
<span class="sd">        url: file location string in ``nf://&lt;filepath&gt;`` format</span>
<span class="sd">        raise_on_fail: raise FIleNotFoundError if download fails</span>
<span class="sd">        read: if True returns file content, return OS path to saved file otherwise</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: File content if read is True, otherwise OS path to the saved file.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: If raise_on_fail is True and the download fails.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">status</span><span class="p">,</span> <span class="n">file_content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">fetch_file</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">read</span><span class="o">=</span><span class="n">read</span><span class="p">)</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> - worker &#39;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&#39; fetch file failed with status &#39;</span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">&#39;&quot;</span>

    <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;200&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">file_content</span>
    <span class="k">elif</span> <span class="n">raise_on_fail</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="norfab.core.worker.NFPWorker.fetch_jinja2" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fetch_jinja2</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

<a href="#norfab.core.worker.NFPWorker.fetch_jinja2" class="headerlink" title="Permanent link">¤</a></h3>


    <div class="doc doc-contents ">

        <p>Helper function to recursively download a Jinja2 template along with
other templates referenced using "include" statements.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>url</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A URL in the format <code>nf://file/path</code> to download the file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file path of the downloaded Jinja2 template.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>FileNotFoundError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the file download fails.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>Exception</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If Jinja2 template parsing fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fetch_jinja2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function to recursively download a Jinja2 template along with</span>
<span class="sd">    other templates referenced using &quot;include&quot; statements.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): A URL in the format ``nf://file/path`` to download the file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The file path of the downloaded Jinja2 template.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: If the file download fails.</span>
<span class="sd">        Exception: If Jinja2 template parsing fails.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filepath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">read</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">filepath</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> - file download failed &#39;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="c1"># download Jinja2 template &quot;include&quot;-ed files</span>
    <span class="n">content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">read</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">j2env</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">(</span><span class="n">loader</span><span class="o">=</span><span class="s2">&quot;BaseLoader&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">parsed_content</span> <span class="o">=</span> <span class="n">j2env</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> - Jinja2 template parsing failed &#39;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&#39;, error: &#39;</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="c1"># run recursion on include statements</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">parsed_content</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="n">Include</span><span class="p">):</span>
        <span class="n">include_file</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">template</span><span class="o">.</span><span class="n">value</span>
        <span class="n">base_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">url</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fetch_jinja2</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_path</span><span class="p">,</span> <span class="n">include_file</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">filepath</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="norfab.core.worker.NFPWorker.event" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">event</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">NorFabEvent</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

<a href="#norfab.core.worker.NFPWorker.event" class="headerlink" title="Permanent link">¤</a></h3>


    <div class="doc doc-contents ">

        <p>Handles the creation and emission of an event.</p>
<p>This method takes event data, processes it, and sends it to the event queue.
It also saves the event data locally for future reference.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="norfab.core.models.NorFabEvent">NorFabEvent</span>, str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The event data, which can be either an instance of NorFabEvent or a string.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments to be passed when creating a NorFabEvent instance if <code>data</code> is a string.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="logs" open>
  <summary>Logs</summary>
  <p>Error: Logs an error message if the event data cannot be formed.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">NorFabEvent</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles the creation and emission of an event.</span>

<span class="sd">    This method takes event data, processes it, and sends it to the event queue.</span>
<span class="sd">    It also saves the event data locally for future reference.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (Union[NorFabEvent, str]): The event data, which can be either an instance of NorFabEvent or a string.</span>
<span class="sd">        **kwargs: Additional keyword arguments to be passed when creating a NorFabEvent instance if `data` is a string.</span>

<span class="sd">    Logs:</span>
<span class="sd">        Error: Logs an error message if the event data cannot be formed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">NorFabEvent</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">NorFabEvent</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to form event data, error </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span><span class="n">exclude_none</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># form event ZeroMQ payload</span>
    <span class="n">event_item</span> <span class="o">=</span> <span class="p">[</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_job</span><span class="p">[</span><span class="s2">&quot;client_address&quot;</span><span class="p">],</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_job</span><span class="p">[</span><span class="s2">&quot;juuid&quot;</span><span class="p">],</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_job</span><span class="p">[</span><span class="s2">&quot;task&quot;</span><span class="p">],</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_job</span><span class="p">[</span><span class="s2">&quot;timeout&quot;</span><span class="p">],</span>
        <span class="n">data</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="c1"># emit event to the broker</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">event_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">event_item</span><span class="p">)</span>
    <span class="c1"># save event locally</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">event_filename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_job</span><span class="p">[</span><span class="s2">&quot;juuid&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_dir_jobs</span><span class="p">)</span>
    <span class="n">events</span> <span class="o">=</span> <span class="n">loader</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">else</span> <span class="p">[]</span>
    <span class="n">events</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event_item</span><span class="p">)</span>
    <span class="n">dumper</span><span class="p">(</span><span class="n">events</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="norfab.core.worker.NFPWorker.job_details" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">job_details</span><span class="p">(</span><span class="n">uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">result</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">events</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Result</span></code>

<a href="#norfab.core.worker.NFPWorker.job_details" class="headerlink" title="Permanent link">¤</a></h3>


    <div class="doc doc-contents ">

        <p>Method to get job details by UUID for completed jobs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>uuid</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The job UUID to return details for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, return job data.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>result</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, return job result.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>events</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, return job events.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Result</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="norfab.core.worker.Result" href="#norfab.core.worker.Result">Result</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Result object with the job details.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">job_details</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">uuid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">result</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">events</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Result</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Method to get job details by UUID for completed jobs.</span>

<span class="sd">    Args:</span>
<span class="sd">        uuid (str): The job UUID to return details for.</span>
<span class="sd">        data (bool): If True, return job data.</span>
<span class="sd">        result (bool): If True, return job result.</span>
<span class="sd">        events (bool): If True, return job events.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Result: A Result object with the job details.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">job</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">with</span> <span class="n">queue_file_lock</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">queue_done_filename</span><span class="p">,</span> <span class="s2">&quot;rb+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
                <span class="n">job_data</span><span class="p">,</span> <span class="n">job_result</span><span class="p">,</span> <span class="n">job_events</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[]</span>
                <span class="n">job_entry</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="n">suuid</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">job_entry</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>  <span class="c1"># {suuid}--start--end</span>
                <span class="k">if</span> <span class="n">suuid</span> <span class="o">!=</span> <span class="n">uuid</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="c1"># load job request details</span>
                <span class="n">client_address</span><span class="p">,</span> <span class="n">empty</span><span class="p">,</span> <span class="n">juuid</span><span class="p">,</span> <span class="n">job_data_bytes</span> <span class="o">=</span> <span class="n">loader</span><span class="p">(</span>
                    <span class="n">request_filename</span><span class="p">(</span><span class="n">suuid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_dir_jobs</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
                    <span class="n">job_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">job_data_bytes</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
                <span class="c1"># load job result details</span>
                <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
                    <span class="n">rep_filename</span> <span class="o">=</span> <span class="n">reply_filename</span><span class="p">(</span><span class="n">suuid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_dir_jobs</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">rep_filename</span><span class="p">):</span>
                        <span class="n">job_result</span> <span class="o">=</span> <span class="n">loader</span><span class="p">(</span><span class="n">rep_filename</span><span class="p">)</span>
                        <span class="n">job_result</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">job_result</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
                        <span class="n">job_result</span> <span class="o">=</span> <span class="n">job_result</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
                <span class="c1"># load event details</span>
                <span class="k">if</span> <span class="n">events</span><span class="p">:</span>
                    <span class="n">events_filename</span> <span class="o">=</span> <span class="n">event_filename</span><span class="p">(</span><span class="n">suuid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_dir_jobs</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">events_filename</span><span class="p">):</span>
                        <span class="n">job_events</span> <span class="o">=</span> <span class="n">loader</span><span class="p">(</span><span class="n">events_filename</span><span class="p">)</span>
                        <span class="n">job_events</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">job_events</span><span class="p">]</span>

                <span class="n">job</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="n">suuid</span><span class="p">,</span>
                    <span class="s2">&quot;client&quot;</span><span class="p">:</span> <span class="n">client_address</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
                    <span class="s2">&quot;received_timestamp&quot;</span><span class="p">:</span> <span class="n">start</span><span class="p">,</span>
                    <span class="s2">&quot;done_timestamp&quot;</span><span class="p">:</span> <span class="n">end</span><span class="p">,</span>
                    <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;COMPLETED&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;job_data&quot;</span><span class="p">:</span> <span class="n">job_data</span><span class="p">,</span>
                    <span class="s2">&quot;job_result&quot;</span><span class="p">:</span> <span class="n">job_result</span><span class="p">,</span>
                    <span class="s2">&quot;job_events&quot;</span><span class="p">:</span> <span class="n">job_events</span><span class="p">,</span>
                <span class="p">}</span>

    <span class="k">if</span> <span class="n">job</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Result</span><span class="p">(</span>
            <span class="n">task</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:job_details&quot;</span><span class="p">,</span>
            <span class="n">result</span><span class="o">=</span><span class="n">job</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> - job with UUID &#39;</span><span class="si">{</span><span class="n">uuid</span><span class="si">}</span><span class="s2">&#39; not found&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="norfab.core.worker.NFPWorker.job_list" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">job_list</span><span class="p">(</span><span class="n">pending</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">completed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">task</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">last</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">uuid</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Result</span></code>

<a href="#norfab.core.worker.NFPWorker.job_list" class="headerlink" title="Permanent link">¤</a></h3>


    <div class="doc doc-contents ">

        <p>Method to list worker jobs completed and pending.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pending</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True or None, return pending jobs. If False, skip pending jobs.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>completed</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True or None, return completed jobs. If False, skip completed jobs.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>task</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If provided, return only jobs with this task name.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>last</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If provided, return only the last N completed and last N pending jobs.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If provided, return only jobs submitted by this client.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>uuid</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If provided, return only the job with this UUID.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Result</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="norfab.core.worker.Result" href="#norfab.core.worker.Result">Result</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Result object with a list of jobs.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">job_list</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">pending</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">completed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">task</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">last</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">client</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">uuid</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Result</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Method to list worker jobs completed and pending.</span>

<span class="sd">    Args:</span>
<span class="sd">        pending (bool): If True or None, return pending jobs. If False, skip pending jobs.</span>
<span class="sd">        completed (bool): If True or None, return completed jobs. If False, skip completed jobs.</span>
<span class="sd">        task (str, optional): If provided, return only jobs with this task name.</span>
<span class="sd">        last (int, optional): If provided, return only the last N completed and last N pending jobs.</span>
<span class="sd">        client (str, optional): If provided, return only jobs submitted by this client.</span>
<span class="sd">        uuid (str, optional): If provided, return only the job with this UUID.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Result: Result object with a list of jobs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">job_pending</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># load pending jobs</span>
    <span class="k">if</span> <span class="n">pending</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">queue_file_lock</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">queue_filename</span><span class="p">,</span> <span class="s2">&quot;rb+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
                    <span class="n">job_entry</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="n">suuid</span><span class="p">,</span> <span class="n">start</span> <span class="o">=</span> <span class="n">job_entry</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>  <span class="c1"># {suuid}--start</span>
                    <span class="k">if</span> <span class="n">uuid</span> <span class="ow">and</span> <span class="n">suuid</span> <span class="o">!=</span> <span class="n">uuid</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="n">client_address</span><span class="p">,</span> <span class="n">empty</span><span class="p">,</span> <span class="n">juuid</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">loader</span><span class="p">(</span>
                        <span class="n">request_filename</span><span class="p">(</span><span class="n">suuid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_dir_jobs</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="n">client</span> <span class="ow">and</span> <span class="n">client_address</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="n">client</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="n">job_task</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))[</span><span class="s2">&quot;task&quot;</span><span class="p">]</span>
                    <span class="c1"># check if need to skip this job</span>
                    <span class="k">if</span> <span class="n">task</span> <span class="ow">and</span> <span class="n">job_task</span> <span class="o">!=</span> <span class="n">task</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="n">job_pending</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="n">suuid</span><span class="p">,</span>
                            <span class="s2">&quot;client&quot;</span><span class="p">:</span> <span class="n">client_address</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
                            <span class="s2">&quot;received_timestamp&quot;</span><span class="p">:</span> <span class="n">start</span><span class="p">,</span>
                            <span class="s2">&quot;done_timestamp&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                            <span class="s2">&quot;task&quot;</span><span class="p">:</span> <span class="n">job_task</span><span class="p">,</span>
                            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;PENDING&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;worker&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                            <span class="s2">&quot;service&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
                        <span class="p">}</span>
                    <span class="p">)</span>
    <span class="n">job_completed</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># load done jobs</span>
    <span class="k">if</span> <span class="n">completed</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">queue_file_lock</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">queue_done_filename</span><span class="p">,</span> <span class="s2">&quot;rb+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
                    <span class="n">job_entry</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="n">suuid</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">job_entry</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>  <span class="c1"># {suuid}--start--end</span>
                    <span class="k">if</span> <span class="n">uuid</span> <span class="ow">and</span> <span class="n">suuid</span> <span class="o">!=</span> <span class="n">uuid</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="n">client_address</span><span class="p">,</span> <span class="n">empty</span><span class="p">,</span> <span class="n">juuid</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">loader</span><span class="p">(</span>
                        <span class="n">request_filename</span><span class="p">(</span><span class="n">suuid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_dir_jobs</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="n">client</span> <span class="ow">and</span> <span class="n">client_address</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="n">client</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="n">job_task</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))[</span><span class="s2">&quot;task&quot;</span><span class="p">]</span>
                    <span class="c1"># check if need to skip this job</span>
                    <span class="k">if</span> <span class="n">task</span> <span class="ow">and</span> <span class="n">job_task</span> <span class="o">!=</span> <span class="n">task</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="n">job_completed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="n">suuid</span><span class="p">,</span>
                            <span class="s2">&quot;client&quot;</span><span class="p">:</span> <span class="n">client_address</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
                            <span class="s2">&quot;received_timestamp&quot;</span><span class="p">:</span> <span class="n">start</span><span class="p">,</span>
                            <span class="s2">&quot;done_timestamp&quot;</span><span class="p">:</span> <span class="n">end</span><span class="p">,</span>
                            <span class="s2">&quot;task&quot;</span><span class="p">:</span> <span class="n">job_task</span><span class="p">,</span>
                            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;COMPLETED&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;worker&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                            <span class="s2">&quot;service&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
                        <span class="p">}</span>
                    <span class="p">)</span>
    <span class="k">if</span> <span class="n">last</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Result</span><span class="p">(</span>
            <span class="n">task</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:job_list&quot;</span><span class="p">,</span>
            <span class="n">result</span><span class="o">=</span><span class="n">job_completed</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">job_completed</span><span class="p">)</span> <span class="o">-</span> <span class="n">last</span> <span class="p">:]</span>
            <span class="o">+</span> <span class="n">job_pending</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">job_pending</span><span class="p">)</span> <span class="o">-</span> <span class="n">last</span> <span class="p">:],</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Result</span><span class="p">(</span>
            <span class="n">task</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:job_list&quot;</span><span class="p">,</span>
            <span class="n">result</span><span class="o">=</span><span class="n">job_completed</span> <span class="o">+</span> <span class="n">job_pending</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="norfab.core.worker.NFPWorker.work" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">work</span><span class="p">()</span></code>

<a href="#norfab.core.worker.NFPWorker.work" class="headerlink" title="Permanent link">¤</a></h3>


    <div class="doc doc-contents ">

        <p>Starts multiple threads to handle different tasks and processes jobs in a
loop until an exit or destroy event is set.</p>
<p>Threads started:</p>
<ul>
<li>request_thread: Handles posting requests.</li>
<li>reply_thread: Handles getting replies.</li>
<li>close_thread: Handles closing operations.</li>
<li>event_thread: Handles event processing.</li>
<li>recv_thread: Handles receiving data.</li>
</ul>
<p>Main work loop:</p>
<ul>
<li>Continuously checks for jobs to process from a queue file.</li>
<li>Loads job data and executes the corresponding task.</li>
<li>Saves the result of the job to a reply file.</li>
<li>Marks the job as processed by moving it from the queue file to a queue done file.</li>
</ul>
<p>Ensures proper cleanup by calling the destroy method when exit or destroy events are set.</p>

            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">work</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Starts multiple threads to handle different tasks and processes jobs in a</span>
<span class="sd">    loop until an exit or destroy event is set.</span>

<span class="sd">    Threads started:</span>

<span class="sd">    - request_thread: Handles posting requests.</span>
<span class="sd">    - reply_thread: Handles getting replies.</span>
<span class="sd">    - close_thread: Handles closing operations.</span>
<span class="sd">    - event_thread: Handles event processing.</span>
<span class="sd">    - recv_thread: Handles receiving data.</span>

<span class="sd">    Main work loop:</span>

<span class="sd">    - Continuously checks for jobs to process from a queue file.</span>
<span class="sd">    - Loads job data and executes the corresponding task.</span>
<span class="sd">    - Saves the result of the job to a reply file.</span>
<span class="sd">    - Marks the job as processed by moving it from the queue file to a queue done file.</span>

<span class="sd">    Ensures proper cleanup by calling the destroy method when exit or destroy events are set.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Start threads</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">request_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span>
        <span class="n">target</span><span class="o">=</span><span class="n">_post</span><span class="p">,</span>
        <span class="n">daemon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_post_thread&quot;</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">post_queue</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">queue_filename</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">destroy_event</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">base_dir_jobs</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">request_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reply_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span>
        <span class="n">target</span><span class="o">=</span><span class="n">_get</span><span class="p">,</span>
        <span class="n">daemon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_get_thread&quot;</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_queue</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">destroy_event</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_dir_jobs</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reply_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">close_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span>
        <span class="n">target</span><span class="o">=</span><span class="n">close</span><span class="p">,</span>
        <span class="n">daemon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_close_thread&quot;</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delete_queue</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">queue_filename</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">destroy_event</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">base_dir_jobs</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">close_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">event_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span>
        <span class="n">target</span><span class="o">=</span><span class="n">_event</span><span class="p">,</span>
        <span class="n">daemon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_event_thread&quot;</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">event_queue</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">destroy_event</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">event_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="c1"># start receive thread after other threads</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">recv_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span>
        <span class="n">target</span><span class="o">=</span><span class="n">recv</span><span class="p">,</span>
        <span class="n">daemon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_recv_thread&quot;</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">destroy_event</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">recv_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="c1"># start main work loop</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">exit_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">destroy_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
        <span class="c1"># get some job to do</span>
        <span class="k">with</span> <span class="n">queue_file_lock</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">queue_filename</span><span class="p">,</span> <span class="s2">&quot;rb+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="c1"># get first UUID</span>
                <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
                    <span class="n">entry</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">entry</span><span class="p">:</span>
                        <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>
                    <span class="k">continue</span>

        <span class="c1"># load job data</span>
        <span class="n">suuid</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;--&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># {suuid}--start--</span>

        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> - processing request </span><span class="si">{</span><span class="n">suuid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">client_address</span><span class="p">,</span> <span class="n">empty</span><span class="p">,</span> <span class="n">juuid</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">loader</span><span class="p">(</span>
            <span class="n">request_filename</span><span class="p">(</span><span class="n">suuid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_dir_jobs</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">task</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;task&quot;</span><span class="p">)</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;args&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;kwargs&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">timeout</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;timeout&quot;</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">current_job</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;client_address&quot;</span><span class="p">:</span> <span class="n">client_address</span><span class="p">,</span>
            <span class="s2">&quot;juuid&quot;</span><span class="p">:</span> <span class="n">juuid</span><span class="p">,</span>
            <span class="s2">&quot;task&quot;</span><span class="p">:</span> <span class="n">task</span><span class="p">,</span>
            <span class="s2">&quot;timeout&quot;</span><span class="p">:</span> <span class="n">timeout</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> - doing task &#39;</span><span class="si">{</span><span class="n">task</span><span class="si">}</span><span class="s2">&#39;, timeout: &#39;</span><span class="si">{</span><span class="n">timeout</span><span class="si">}</span><span class="s2">&#39;, data: &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s2">&#39;, args: &#39;</span><span class="si">{</span><span class="n">args</span><span class="si">}</span><span class="s2">&#39;, kwargs: &#39;</span><span class="si">{</span><span class="n">kwargs</span><span class="si">}</span><span class="s2">&#39;, client: &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">client_address</span><span class="si">}</span><span class="s2">&#39;, job uuid: &#39;</span><span class="si">{</span><span class="n">juuid</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="p">)</span>

        <span class="c1"># run the actual job</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">Result</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> - task &#39;</span><span class="si">{</span><span class="n">task</span><span class="si">}</span><span class="s2">&#39; did not return Result object, data: </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s2">, args: &#39;</span><span class="si">{</span><span class="n">args</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;kwargs: &#39;</span><span class="si">{</span><span class="n">kwargs</span><span class="si">}</span><span class="s2">&#39;, client: &#39;</span><span class="si">{</span><span class="n">client_address</span><span class="si">}</span><span class="s2">&#39;, job uuid: &#39;</span><span class="si">{</span><span class="n">juuid</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="s2">&quot;task&quot;</span><span class="p">):</span>
                <span class="n">result</span><span class="o">.</span><span class="n">task</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">task</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="s2">&quot;juuid&quot;</span><span class="p">):</span>
                <span class="n">result</span><span class="o">.</span><span class="n">juuid</span> <span class="o">=</span> <span class="n">juuid</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Result</span><span class="p">(</span>
                <span class="n">task</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">task</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">errors</span><span class="o">=</span><span class="p">[</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()],</span>
                <span class="n">messages</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Worker experienced error: &#39;</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">],</span>
                <span class="n">failed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> - worker experienced error:</span><span class="se">\n</span><span class="si">{</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="c1"># save job results to reply file</span>
        <span class="n">dumper</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">client_address</span><span class="p">,</span>
                <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="n">suuid</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
                <span class="sa">b</span><span class="s2">&quot;200&quot;</span><span class="p">,</span>
                <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">dictionary</span><span class="p">()})</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
            <span class="p">],</span>
            <span class="n">reply_filename</span><span class="p">(</span><span class="n">suuid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_dir_jobs</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># mark job entry as processed - remove from queue file and save into queue done file</span>
        <span class="k">with</span> <span class="n">queue_file_lock</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">queue_filename</span><span class="p">,</span> <span class="s2">&quot;rb+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">qf</span><span class="p">:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">queue_done_filename</span><span class="p">,</span> <span class="s2">&quot;rb+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">qdf</span><span class="p">:</span>
                    <span class="n">qdf</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">SEEK_END</span><span class="p">)</span>  <span class="c1"># go to the end</span>
                    <span class="n">entries</span> <span class="o">=</span> <span class="n">qf</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
                    <span class="n">qf</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">SEEK_SET</span><span class="p">)</span>  <span class="c1"># go to the beginning</span>
                    <span class="n">qf</span><span class="o">.</span><span class="n">truncate</span><span class="p">()</span>  <span class="c1"># empty file content</span>
                    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
                        <span class="n">entry</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                        <span class="c1"># save done entry to queue_done_filename</span>
                        <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">suuid</span><span class="p">):</span>
                            <span class="n">entry</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s2">--</span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">ctime</span><span class="p">()</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
                            <span class="n">qdf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
                        <span class="c1"># re-save remaining entries to queue_filename</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">qf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>

    <span class="c1"># make sure to clean up</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">destroy</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> - exit event is set &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">exit_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">()</span><span class="si">}</span><span class="s2">&#39;, &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;destroy event is set &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">destroy_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">()</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="norfab.core.worker.dumper" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dumper</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span></code>

<a href="#norfab.core.worker.dumper" class="headerlink" title="Permanent link">¤</a></h2>


    <div class="doc doc-contents ">

        <p>Serializes and saves data to a file using pickle.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code>any</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data to be serialized and saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the file where the data will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">dumper</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Serializes and saves data to a file using pickle.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (any): The data to be serialized and saved.</span>
<span class="sd">        filename (str): The name of the file where the data will be saved.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">file_write_lock</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="norfab.core.worker.loader" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">loader</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></code>

<a href="#norfab.core.worker.loader" class="headerlink" title="Permanent link">¤</a></h2>


    <div class="doc doc-contents ">

        <p>Load and deserialize a Python object from a file.</p>
<p>This function opens a file in binary read mode, reads its content, and
deserializes it using the pickle module. The file access is synchronized
using a file write lock to ensure thread safety.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the file to be loaded.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>object</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The deserialized Python object from the file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">loader</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load and deserialize a Python object from a file.</span>

<span class="sd">    This function opens a file in binary read mode, reads its content, and</span>
<span class="sd">    deserializes it using the pickle module. The file access is synchronized</span>
<span class="sd">    using a file write lock to ensure thread safety.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): The path to the file to be loaded.</span>

<span class="sd">    Returns:</span>
<span class="sd">        object: The deserialized Python object from the file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">file_write_lock</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="norfab.core.worker.request_filename" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">request_filename</span><span class="p">(</span><span class="n">suuid</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span> <span class="n">base_dir_jobs</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span></code>

<a href="#norfab.core.worker.request_filename" class="headerlink" title="Permanent link">¤</a></h2>


    <div class="doc doc-contents ">

        <p>Returns a freshly allocated request filename for the given UUID string.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>suuid</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[str, bytes]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The UUID string or bytes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>base_dir_jobs</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The base directory where job files are stored.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The full path to the request file with the given UUID.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">request_filename</span><span class="p">(</span><span class="n">suuid</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span> <span class="n">base_dir_jobs</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a freshly allocated request filename for the given UUID string.</span>

<span class="sd">    Args:</span>
<span class="sd">        suuid (Union[str, bytes]): The UUID string or bytes.</span>
<span class="sd">        base_dir_jobs (str): The base directory where job files are stored.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The full path to the request file with the given UUID.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">suuid</span> <span class="o">=</span> <span class="n">suuid</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">suuid</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span> <span class="k">else</span> <span class="n">suuid</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir_jobs</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">suuid</span><span class="si">}</span><span class="s2">.req&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="norfab.core.worker.reply_filename" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reply_filename</span><span class="p">(</span><span class="n">suuid</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span> <span class="n">base_dir_jobs</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span></code>

<a href="#norfab.core.worker.reply_filename" class="headerlink" title="Permanent link">¤</a></h2>


    <div class="doc doc-contents ">

        <p>Returns a freshly allocated reply filename for the given UUID string.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>suuid</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[str, bytes]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The UUID string or bytes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>base_dir_jobs</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The base directory where job files are stored.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The full path to the reply file with the given UUID.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reply_filename</span><span class="p">(</span><span class="n">suuid</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span> <span class="n">base_dir_jobs</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a freshly allocated reply filename for the given UUID string.</span>

<span class="sd">    Args:</span>
<span class="sd">        suuid (Union[str, bytes]): The UUID string or bytes.</span>
<span class="sd">        base_dir_jobs (str): The base directory where job files are stored.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The full path to the reply file with the given UUID.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">suuid</span> <span class="o">=</span> <span class="n">suuid</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">suuid</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span> <span class="k">else</span> <span class="n">suuid</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir_jobs</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">suuid</span><span class="si">}</span><span class="s2">.rep&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="norfab.core.worker.event_filename" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">event_filename</span><span class="p">(</span><span class="n">suuid</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span> <span class="n">base_dir_jobs</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span></code>

<a href="#norfab.core.worker.event_filename" class="headerlink" title="Permanent link">¤</a></h2>


    <div class="doc doc-contents ">

        <p>Returns a freshly allocated event filename for the given UUID string.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>suuid</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[str, bytes]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The UUID string or bytes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>base_dir_jobs</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The base directory where job files are stored.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The full path to the event file with the given UUID.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">event_filename</span><span class="p">(</span><span class="n">suuid</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span> <span class="n">base_dir_jobs</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a freshly allocated event filename for the given UUID string.</span>

<span class="sd">    Args:</span>
<span class="sd">        suuid (Union[str, bytes]): The UUID string or bytes.</span>
<span class="sd">        base_dir_jobs (str): The base directory where job files are stored.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The full path to the event file with the given UUID.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">suuid</span> <span class="o">=</span> <span class="n">suuid</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">suuid</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span> <span class="k">else</span> <span class="n">suuid</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir_jobs</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">suuid</span><span class="si">}</span><span class="s2">.event&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="norfab.core.worker._post" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_post</span><span class="p">(</span><span class="n">worker</span><span class="p">,</span> <span class="n">post_queue</span><span class="p">,</span> <span class="n">queue_filename</span><span class="p">,</span> <span class="n">destroy_event</span><span class="p">,</span> <span class="n">base_dir_jobs</span><span class="p">)</span></code>

<a href="#norfab.core.worker._post" class="headerlink" title="Permanent link">¤</a></h2>


    <div class="doc doc-contents ">

        <p>Thread to receive POST requests and save them to hard disk.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>worker</code>
            </td>
            <td>
                  <code>Worker</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The worker instance handling the request.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>post_queue</code>
            </td>
            <td>
                  <code><span title="queue.Queue">Queue</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The queue from which POST requests are received.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>queue_filename</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The filename where the job queue is stored.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>destroy_event</code>
            </td>
            <td>
                  <code><span title="threading.Event">Event</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Event to signal the thread to stop.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>base_dir_jobs</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The base directory where job files are stored.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="functionality" open>
  <summary>Functionality</summary>
  <ul>
<li>Ensures the message directory exists.</li>
<li>Continuously processes POST requests from the queue until the destroy event is set.</li>
<li>Saves the request to the hard disk.</li>
<li>Writes a reply indicating the job is pending.</li>
<li>Adds the job request to the queue file.</li>
<li>Sends an acknowledgment back to the client.</li>
</ul>
</details>
            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_post</span><span class="p">(</span><span class="n">worker</span><span class="p">,</span> <span class="n">post_queue</span><span class="p">,</span> <span class="n">queue_filename</span><span class="p">,</span> <span class="n">destroy_event</span><span class="p">,</span> <span class="n">base_dir_jobs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Thread to receive POST requests and save them to hard disk.</span>

<span class="sd">    Args:</span>
<span class="sd">        worker (Worker): The worker instance handling the request.</span>
<span class="sd">        post_queue (queue.Queue): The queue from which POST requests are received.</span>
<span class="sd">        queue_filename (str): The filename where the job queue is stored.</span>
<span class="sd">        destroy_event (threading.Event): Event to signal the thread to stop.</span>
<span class="sd">        base_dir_jobs (str): The base directory where job files are stored.</span>

<span class="sd">    Functionality:</span>
<span class="sd">        - Ensures the message directory exists.</span>
<span class="sd">        - Continuously processes POST requests from the queue until the destroy event is set.</span>
<span class="sd">        - Saves the request to the hard disk.</span>
<span class="sd">        - Writes a reply indicating the job is pending.</span>
<span class="sd">        - Adds the job request to the queue file.</span>
<span class="sd">        - Sends an acknowledgment back to the client.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Ensure message directory exists</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">base_dir_jobs</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">base_dir_jobs</span><span class="p">)</span>

    <span class="k">while</span> <span class="ow">not</span> <span class="n">destroy_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">work</span> <span class="o">=</span> <span class="n">post_queue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">queue</span><span class="o">.</span><span class="n">Empty</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">ctime</span><span class="p">()</span>
        <span class="n">client_address</span> <span class="o">=</span> <span class="n">work</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">suuid</span> <span class="o">=</span> <span class="n">work</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">request_filename</span><span class="p">(</span><span class="n">suuid</span><span class="p">,</span> <span class="n">base_dir_jobs</span><span class="p">)</span>
        <span class="n">dumper</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

        <span class="c1"># write reply for this job indicating it is pending</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">reply_filename</span><span class="p">(</span><span class="n">suuid</span><span class="p">,</span> <span class="n">base_dir_jobs</span><span class="p">)</span>
        <span class="n">dumper</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">client_address</span><span class="p">,</span>
                <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="n">suuid</span><span class="p">,</span>
                <span class="sa">b</span><span class="s2">&quot;300&quot;</span><span class="p">,</span>
                <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;worker&quot;</span><span class="p">:</span> <span class="n">worker</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                        <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="n">suuid</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
                        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;PENDING&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;service&quot;</span><span class="p">:</span> <span class="n">worker</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
                    <span class="p">}</span>
                <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
            <span class="p">],</span>
            <span class="n">filename</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">worker</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> - &#39;</span><span class="si">{</span><span class="n">suuid</span><span class="si">}</span><span class="s2">&#39; job, saved PENDING reply filename&quot;</span><span class="p">)</span>

        <span class="c1"># add job request to the queue_filename</span>
        <span class="k">with</span> <span class="n">queue_file_lock</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">queue_filename</span><span class="p">,</span> <span class="s2">&quot;ab&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">suuid</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">--</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">worker</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> - &#39;</span><span class="si">{</span><span class="n">suuid</span><span class="si">}</span><span class="s2">&#39; job, added job to queue filename&quot;</span><span class="p">)</span>

        <span class="c1"># ack job back to client</span>
        <span class="n">worker</span><span class="o">.</span><span class="n">send_to_broker</span><span class="p">(</span>
            <span class="n">NFP</span><span class="o">.</span><span class="n">RESPONSE</span><span class="p">,</span>
            <span class="p">[</span>
                <span class="n">client_address</span><span class="p">,</span>
                <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="n">suuid</span><span class="p">,</span>
                <span class="sa">b</span><span class="s2">&quot;202&quot;</span><span class="p">,</span>
                <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;worker&quot;</span><span class="p">:</span> <span class="n">worker</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                        <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="n">suuid</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
                        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;ACCEPTED&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;service&quot;</span><span class="p">:</span> <span class="n">worker</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
                    <span class="p">}</span>
                <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
            <span class="p">],</span>
        <span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">worker</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> - &#39;</span><span class="si">{</span><span class="n">suuid</span><span class="si">}</span><span class="s2">&#39; job, sent ACK back to client &#39;</span><span class="si">{</span><span class="n">client_address</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="p">)</span>

        <span class="n">post_queue</span><span class="o">.</span><span class="n">task_done</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="norfab.core.worker._get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_get</span><span class="p">(</span><span class="n">worker</span><span class="p">,</span> <span class="n">get_queue</span><span class="p">,</span> <span class="n">destroy_event</span><span class="p">,</span> <span class="n">base_dir_jobs</span><span class="p">)</span></code>

<a href="#norfab.core.worker._get" class="headerlink" title="Permanent link">¤</a></h2>


    <div class="doc doc-contents ">

        <p>Thread to receive GET requests and retrieve results from the hard disk.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>worker</code>
            </td>
            <td>
                  <code>Worker</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The worker instance handling the request.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>get_queue</code>
            </td>
            <td>
                  <code><span title="queue.Queue">Queue</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The queue from which GET requests are received.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>destroy_event</code>
            </td>
            <td>
                  <code><span title="threading.Event">Event</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Event to signal the thread to stop.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>base_dir_jobs</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The base directory where job results are stored.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_get</span><span class="p">(</span><span class="n">worker</span><span class="p">,</span> <span class="n">get_queue</span><span class="p">,</span> <span class="n">destroy_event</span><span class="p">,</span> <span class="n">base_dir_jobs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Thread to receive GET requests and retrieve results from the hard disk.</span>

<span class="sd">    Args:</span>
<span class="sd">        worker (Worker): The worker instance handling the request.</span>
<span class="sd">        get_queue (queue.Queue): The queue from which GET requests are received.</span>
<span class="sd">        destroy_event (threading.Event): Event to signal the thread to stop.</span>
<span class="sd">        base_dir_jobs (str): The base directory where job results are stored.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">destroy_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">work</span> <span class="o">=</span> <span class="n">get_queue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">queue</span><span class="o">.</span><span class="n">Empty</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">client_address</span> <span class="o">=</span> <span class="n">work</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">suuid</span> <span class="o">=</span> <span class="n">work</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">rep_filename</span> <span class="o">=</span> <span class="n">reply_filename</span><span class="p">(</span><span class="n">suuid</span><span class="p">,</span> <span class="n">base_dir_jobs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">rep_filename</span><span class="p">):</span>
            <span class="n">reply</span> <span class="o">=</span> <span class="n">loader</span><span class="p">(</span><span class="n">rep_filename</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">reply</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">client_address</span><span class="p">,</span>
                <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="n">suuid</span><span class="p">,</span>
                <span class="sa">b</span><span class="s2">&quot;400&quot;</span><span class="p">,</span>
                <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;worker&quot;</span><span class="p">:</span> <span class="n">worker</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                        <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="n">suuid</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
                        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;JOB RESULTS NOT FOUND&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;service&quot;</span><span class="p">:</span> <span class="n">worker</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
                    <span class="p">}</span>
                <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
            <span class="p">]</span>

        <span class="n">worker</span><span class="o">.</span><span class="n">send_to_broker</span><span class="p">(</span><span class="n">NFP</span><span class="o">.</span><span class="n">RESPONSE</span><span class="p">,</span> <span class="n">reply</span><span class="p">)</span>

        <span class="n">get_queue</span><span class="o">.</span><span class="n">task_done</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="norfab.core.worker._event" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_event</span><span class="p">(</span><span class="n">worker</span><span class="p">,</span> <span class="n">event_queue</span><span class="p">,</span> <span class="n">destroy_event</span><span class="p">)</span></code>

<a href="#norfab.core.worker._event" class="headerlink" title="Permanent link">¤</a></h2>


    <div class="doc doc-contents ">

        <p>Thread function to emit events to Clients.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>worker</code>
            </td>
            <td>
                  <code>Worker</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The worker instance that is emitting events.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>event_queue</code>
            </td>
            <td>
                  <code><span title="queue.Queue">Queue</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The queue from which events are retrieved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>destroy_event</code>
            </td>
            <td>
                  <code><span title="threading.Event">Event</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An event to signal the thread to stop.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>The function continuously retrieves events from the event_queue, processes them,
and sends them to the broker until the destroy_event is set.</p>

            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_event</span><span class="p">(</span><span class="n">worker</span><span class="p">,</span> <span class="n">event_queue</span><span class="p">,</span> <span class="n">destroy_event</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Thread function to emit events to Clients.</span>

<span class="sd">    Args:</span>
<span class="sd">        worker (Worker): The worker instance that is emitting events.</span>
<span class="sd">        event_queue (queue.Queue): The queue from which events are retrieved.</span>
<span class="sd">        destroy_event (threading.Event): An event to signal the thread to stop.</span>

<span class="sd">    The function continuously retrieves events from the event_queue, processes them,</span>
<span class="sd">    and sends them to the broker until the destroy_event is set.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">destroy_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">work</span> <span class="o">=</span> <span class="n">event_queue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">queue</span><span class="o">.</span><span class="n">Empty</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">client_address</span> <span class="o">=</span> <span class="n">work</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">suuid</span> <span class="o">=</span> <span class="n">work</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">task</span> <span class="o">=</span> <span class="n">work</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">timeout</span> <span class="o">=</span> <span class="n">work</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">work</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>

        <span class="n">event</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">client_address</span><span class="p">,</span>
            <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">suuid</span><span class="p">,</span>
            <span class="sa">b</span><span class="s2">&quot;200&quot;</span><span class="p">,</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;worker&quot;</span><span class="p">:</span> <span class="n">worker</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="s2">&quot;service&quot;</span><span class="p">:</span> <span class="n">worker</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
                    <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="n">suuid</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
                    <span class="s2">&quot;task&quot;</span><span class="p">:</span> <span class="n">task</span><span class="p">,</span>
                    <span class="s2">&quot;timeout&quot;</span><span class="p">:</span> <span class="n">timeout</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">data</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
        <span class="p">]</span>

        <span class="n">worker</span><span class="o">.</span><span class="n">send_to_broker</span><span class="p">(</span><span class="n">NFP</span><span class="o">.</span><span class="n">EVENT</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>

        <span class="n">event_queue</span><span class="o">.</span><span class="n">task_done</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="norfab.core.worker.recv" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">recv</span><span class="p">(</span><span class="n">worker</span><span class="p">,</span> <span class="n">destroy_event</span><span class="p">)</span></code>

<a href="#norfab.core.worker.recv" class="headerlink" title="Permanent link">¤</a></h2>


    <div class="doc doc-contents ">

        <p>Thread to process receive messages from broker.</p>
<p>This function runs in a loop, polling the worker's broker socket for messages every second.
When a message is received, it processes the message based on the command type and places
it into the appropriate queue or handles it accordingly. If the keepaliver thread is not
alive, it logs a warning and attempts to reconnect to the broker.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>worker</code>
            </td>
            <td>
                  <code>Worker</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The worker instance that contains the broker socket and queues.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>destroy_event</code>
            </td>
            <td>
                  <code><span title="threading.Event">Event</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An event to signal the thread to stop.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="commands" open>
  <summary>Commands</summary>
  <ul>
<li>NFP.POST: Places the message into the post_queue.</li>
<li>NFP.DELETE: Places the message into the delete_queue.</li>
<li>NFP.GET: Places the message into the get_queue.</li>
<li>NFP.KEEPALIVE: Processes a keepalive heartbeat.</li>
<li>NFP.DISCONNECT: Attempts to reconnect to the broker.</li>
<li>Other: Logs an invalid input message.</li>
</ul>
</details>
            <details class="quote">
              <summary>Source code in <code>norfab\core\worker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">recv</span><span class="p">(</span><span class="n">worker</span><span class="p">,</span> <span class="n">destroy_event</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Thread to process receive messages from broker.</span>

<span class="sd">    This function runs in a loop, polling the worker&#39;s broker socket for messages every second.</span>
<span class="sd">    When a message is received, it processes the message based on the command type and places</span>
<span class="sd">    it into the appropriate queue or handles it accordingly. If the keepaliver thread is not</span>
<span class="sd">    alive, it logs a warning and attempts to reconnect to the broker.</span>

<span class="sd">    Args:</span>
<span class="sd">        worker (Worker): The worker instance that contains the broker socket and queues.</span>
<span class="sd">        destroy_event (threading.Event): An event to signal the thread to stop.</span>

<span class="sd">    Commands:</span>
<span class="sd">        - NFP.POST: Places the message into the post_queue.</span>
<span class="sd">        - NFP.DELETE: Places the message into the delete_queue.</span>
<span class="sd">        - NFP.GET: Places the message into the get_queue.</span>
<span class="sd">        - NFP.KEEPALIVE: Processes a keepalive heartbeat.</span>
<span class="sd">        - NFP.DISCONNECT: Attempts to reconnect to the broker.</span>
<span class="sd">        - Other: Logs an invalid input message.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">destroy_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
        <span class="c1"># Poll socket for messages every second</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">items</span> <span class="o">=</span> <span class="n">worker</span><span class="o">.</span><span class="n">poller</span><span class="o">.</span><span class="n">poll</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
            <span class="k">break</span>  <span class="c1"># Interrupted</span>
        <span class="k">if</span> <span class="n">items</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">worker</span><span class="o">.</span><span class="n">broker_socket</span><span class="o">.</span><span class="n">recv_multipart</span><span class="p">()</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">worker</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> - received &#39;</span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
            <span class="n">empty</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">header</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">command</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">command</span> <span class="o">==</span> <span class="n">NFP</span><span class="o">.</span><span class="n">POST</span><span class="p">:</span>
                <span class="n">worker</span><span class="o">.</span><span class="n">post_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="n">NFP</span><span class="o">.</span><span class="n">DELETE</span><span class="p">:</span>
                <span class="n">worker</span><span class="o">.</span><span class="n">delete_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="n">NFP</span><span class="o">.</span><span class="n">GET</span><span class="p">:</span>
                <span class="n">worker</span><span class="o">.</span><span class="n">get_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="n">NFP</span><span class="o">.</span><span class="n">KEEPALIVE</span><span class="p">:</span>
                <span class="n">worker</span><span class="o">.</span><span class="n">keepaliver</span><span class="o">.</span><span class="n">received_heartbeat</span><span class="p">([</span><span class="n">header</span><span class="p">]</span> <span class="o">+</span> <span class="n">msg</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="n">NFP</span><span class="o">.</span><span class="n">DISCONNECT</span><span class="p">:</span>
                <span class="n">worker</span><span class="o">.</span><span class="n">reconnect_to_broker</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">worker</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> - invalid input, header &#39;</span><span class="si">{</span><span class="n">header</span><span class="si">}</span><span class="s2">&#39;, command &#39;</span><span class="si">{</span><span class="n">command</span><span class="si">}</span><span class="s2">&#39;, message &#39;</span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">worker</span><span class="o">.</span><span class="n">keepaliver</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">worker</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> - &#39;</span><span class="si">{</span><span class="n">worker</span><span class="o">.</span><span class="n">broker</span><span class="si">}</span><span class="s2">&#39; broker keepalive expired&quot;</span><span class="p">)</span>
            <span class="n">worker</span><span class="o">.</span><span class="n">reconnect_to_broker</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/dmulyalin" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/DMulyalin" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.top", "toc.follow", "navigation.instant", "navigation.instant.progress", "content.footnote.tooltips", "content.code.copy", "content.code.annotate"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
    
  </body>
</html>